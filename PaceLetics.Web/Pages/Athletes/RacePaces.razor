@page "/Athletes/racepaces"

@using AthleteDataAccessLibrary;
@using AthleteDataAccessLibrary.Contracts;
@using MudBlazor.Extensions.Core;
@using MudBlazor;
@using PaceLetics.AthleteModule.CodeBase.Interfaces
@using PaceLetics.CoreModule.Infrastructure.Interfaces
@using PaceLetics.AthleteModule.Components

@inject AuthenticationStateProvider GetAuthenticationStateAsync
@inject IAthleteData AthleteData
@inject IJSRuntime js
@inject IDialogService dialogService
@inject IVdotService vdotService
@inject IPaceModelProvider pmProvider

<PageTitle>Deine Laufdaten</PageTitle>

<MudContainer Class="pt-6 px-6 pb-8" MaxWidth="MaxWidth.Small">

    @if (_isLoading)
    {
        <LoadingScreen Label="Deine Daten werden geladen..." />
    }
    else
    {
        <PageHeader Title="Deine Laufdaten"
                    Subtitle="Hier kannst du einen neuen Einstufungslauf eintragen oder den vorhandenen editieren." />

        <MudDivider Class="my-4" />

        <MudStack Spacing="3">

            @if (_athlete?.ActiveReferenceResult is null)
            {
                <MudAlert Severity="Severity.Warning" Variant="Variant.Outlined">
                    Füge einen aktuellen Einstufungslauf hinzu, damit wir deine Trainingsbereiche für dich ermitteln können.
                </MudAlert>

                <MudButton Variant="Variant.Filled"
                           Color="Color.Warning"
                           StartIcon="@Icons.Material.Filled.AddCircle"
                           OnClick="AddAthlete">
                    Einstufungslauf hinzufügen
                </MudButton>
            }
            else
            {
                <RaceCard OnEditRaceCard="@AddAthlete" Model="@_athlete.ActiveReferenceResult" />

                @if ((DateTime.Now - _athlete.ActiveReferenceResult.Date).TotalDays > 180)
                {
                    <MudAlert Severity="Severity.Info" Variant="Variant.Outlined">
                        Dein Einstufungslauf liegt schon mehr als 6 Monate zurück. Für ein optimales Training
                        solltest du einen aktuelleren Referenzlauf verwenden.
                    </MudAlert>
                }

                <VdotCard Data="@_vdotData" />
            }

        </MudStack>
    }

</MudContainer>



